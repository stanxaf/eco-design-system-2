# AI Assistant Instructions

## Project Context
This is a design system registry optimized for v0.dev integration at DTN Weather Data Company. This is the ONLY design system used across hundreds of projects in different environments.

## Critical Rules - NEVER BREAK THESE

### üö® Rule 1: Protect v0 Integration
When modifying `scripts/build-registry.js`:
- **NEVER** remove `registry:style` from the file content handling (line 237)
- This is REQUIRED for v0 to receive CSS content
- Breaking this will cause all v0 renders to lose custom styles

```javascript
// MUST include registry:style - DO NOT REMOVE
if (
  (file.type === "registry:component" ||
   file.type === "registry:page" ||
   file.type === "registry:style" ||    // ‚ö†Ô∏è CRITICAL
   file.type === "registry:file") &&
  file.path
) {
```

### üö® Rule 2: Protect Theme cssVars
When modifying `registry.json`:
- The theme item MUST always have the `cssVars` property
- cssVars must include three sections: `theme`, `light`, and `dark`
- Colors must be in hex (#007bd9) or HSL format
- **NEVER** use CSS variable references like `"primary": "var(--blue-500)"`

### üö® Rule 3: Always Rebuild After Changes
After ANY changes to:
- `registry.json`
- Component files referenced in registry
- `globals.css`

You MUST run: `node scripts/build-registry.js`

### üö® Rule 4: Component Dependencies
When adding new components, always include theme dependency:
```json
"registryDependencies": [
  "https://eco-design-system-2.vercel.app/r/themes/theme.json"
]
```

### üö® Rule 5: No Inline Styles
User prefers NEVER to use inline style attributes for background colors:
```javascript
// ‚ùå NEVER DO THIS
<div style={{ backgroundColor: "var(--bg-components-light)" }}>

// ‚úÖ DO THIS INSTEAD
<div className="bg-component-light">
```

## Before Suggesting Changes

1. ‚úÖ Check if change affects v0 integration
2. ‚úÖ Reference `V0_INTEGRATION.md` for requirements
3. ‚úÖ Never remove `cssVars` or `registry:style` handling
4. ‚úÖ Consider impact on hundreds of DTN projects
5. ‚úÖ Verify changes work in version 0 of design system

## After Making Changes

Always verify v0 compatibility:
```bash
node scripts/build-registry.js
npm run verify:v0
```

Should output:
```
‚úÖ cssVars present
‚úÖ content present
```

## Common Tasks

### Adding a New Component
1. Create component file in appropriate directory
2. Add entry to `registry.json` with theme dependency
3. Run `node scripts/build-registry.js`
4. Verify component appears in `public/r/styles/` or `public/r/components/`

### Updating Colors
1. Update `src/app/globals.css` (source of truth)
2. Update `cssVars` in `registry.json` to match
3. Run `node scripts/build-registry.js`
4. Test in v0 to verify

### Debugging v0 Issues
1. Check `V0_INTEGRATION.md` ‚Üí "Common Issues" section
2. Run `npm run verify:v0`
3. Verify registry URL is accessible
4. Check browser console in v0

## Testing
```bash
# Quick verification
npm run verify:v0

# Full manual check
cat public/r/themes/theme.json | grep "cssVars" -A 3
cat public/r/themes/theme.json | grep "content" | wc -l  # Should be > 0
```

## Important Context

### User Preferences
- Concise responses, minimal scope
- Explain solution before writing code
- No automatic commits/pushes
- Reuse existing registry components
- Raw component samples in documentation
- High quality, robust code
- Work in version 0 of design system

### Critical Files
- `registry.json` - Source registry with cssVars
- `scripts/build-registry.js` - Must handle registry:style
- `public/r/themes/theme.json` - Generated, must have cssVars + content
- `src/app/globals.css` - Source of truth for all styles

### DO NOT
- Remove cssVars from theme
- Remove registry:style handling
- Use inline styles for backgrounds
- Skip rebuilding after changes
- Commit/push automatically
- Break v0 integration

### ALWAYS
- Read `V0_INTEGRATION.md` when unsure
- Rebuild registry after changes
- Verify v0 compatibility
- Test changes before suggesting
- Keep cssVars in sync with CSS

## Emergency Recovery

If v0 integration breaks:
1. Check git history: `git log --oneline -10`
2. Review changes to `registry.json` and `build-registry.js`
3. Ensure line 237 in `build-registry.js` includes `registry:style`
4. Ensure theme in `registry.json` has `cssVars`
5. Rebuild: `node scripts/build-registry.js`
6. Verify: `npm run verify:v0`

## References
- `V0_INTEGRATION.md` - Complete v0 integration guide
- `REGISTRY_INTEGRATION.md` - General registry documentation
- `fix-v0-custom-styles.plan.md` - Historical fix documentation

